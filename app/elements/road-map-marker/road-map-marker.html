<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<link rel="import" href="../../bower_components/polymer/polymer.html">

<dom-module id="road-map-marker">
  <template>
      <div class='graph'></div>
      <div class='caption'><content></content></div>
  </template>
  <style>
    :host {
      display: inline-block;
      font-weight: bold;
      color: #655;
    }
    :host .caption{
      text-align: center;
      margin-top: 1rem;
    }
    :host .graph {
    display: inline-block;
    position: relative;
    width: 100px;
    height: 100px;
    line-height: 100px;
    border-radius: 50%;
    background: #655;
    background-image: linear-gradient(to right, transparent 50%, yellowgreen 0);
    color: transparent;
    text-align: center;
  }
  @keyframes spin {
    to { transform: rotate(.5turn); }
  }
  @keyframes bg {
    50% { background: yellowgreen; }
  }
  :host .graph:before {
    content: '';
    position: absolute;
    top: 0; left: 50%;
    width: 50%; height: 100%;
    border-radius: 0 100% 100% 0 / 50%;
    background-color: inherit;
    transform-origin: left;
    animation: spin 50s linear infinite, bg 100s step-end infinite;
    animation-play-state: paused;
    animation-delay: inherit;
  }
  </style>

  <script>
    (function() {
      'use strict';
      
      Polymer({
        is: 'road-map-marker',
        properties: {
          completion: {
            type: String,
            notify: true,
            observer: 'updateCompletion'
          },
        },
        ready: function() {
          this.updateCompletion(this.completion);
        },
        updateCompletion: function(newValue) {
          var graph = this.childNodes[1];
          if (newValue === '1'){
            graph.style['background-color'] = 'yellowgreen';
          } else {
            graph.style['background-color'] = '#655';
          }
          graph.style.animationDelay = '-' + newValue*100 + 's';
        }
      });
    })();
  </script>

</dom-module>

<!doctype html>
<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <title>firebase-login</title>

  <script src="../../bower_components/webcomponentsjs/webcomponents.min.js"></script>
  <script src="../../bower_components/web-component-tester/browser.js"></script>
  <script src="../../bower_components/test-fixture/test-fixture-mocha.js"></script>
  <link rel="import" href="../../bower_components/test-fixture/test-fixture.html">
  <script src="../bower_components/iron-test-helpers/mock-interactions.js"></script>

  <!-- Step 1: import the element to test -->
  <link rel="import" href="../elements/firebase-login/firebase-login.html">

</head>
<body>

<test-fixture id="basic">
  <template>
    <firebase-login></firebase-login>
  </template>
</test-fixture>

<script>
  suite('firebase-login tests', function() {
    var fixt;
    var firebaseLogin;

    setup(function() {
      firebaseLogin = fixture('basic');
      // loginbutton = firebaseLogin.$.btnLogin
      loginButton = Polymer.dom(firebaseLogin.root).querySelector('#btnLogin');
      loginModal = Polymer.dom(firebaseLogin.root).querySelector('#loginModal');
    });

    test('default provider is password', function() {
      assert.equal(firebaseLogin.provider, 'password');
    });

    test('a11y test', function() {
      a11ySuite('basic');
    });

    test('baseRef is not set', function() {
      expect(firebaseLogin.baseRef).to.be.equal(undefined);
    });

    test('baseRef is set', function() {
      firebaseLogin.setAttribute('base-ref', 'https://shokka.firebaseio.com');
      expect(firebaseLogin.baseRef).to.be.equal('https://shokka.firebaseio.com');
    });

    // test('Login Modal Opens', function(done) {
    //   assert.ok(loginButton, 'Login Button Exists');
    //   assert.ok(loginModal, 'Login Modal Exists');
    //   loginModal.addEventListener('opened-changed', function(event) {
    //     event.target.removeEventListener(event.type, arguments.callee);
    //     assert.isNotNull(event.detail);
    //     assert.isFalse(true)
    //     done();
    //   });
    //   // loginButton.tap.apply(firebaseLogin, loginButton)
    //   // console.log(loginButton)
    //   // console.dir(loginButton)
    //   // console.log(firebaseLogin)
    //   // console.dir(firebaseLogin)
    //   e = new MouseEvent('click', {
    //     bubbles: true,
    //     cancelable: true,
    //     view: window
    //   });
    //   loginButton.dispatchEvent(e);
    //   // MockInteractions.tap.call(firebaseLogin, loginButton);
    // });

    // test('Test Login', function() {
    //   assert.notEqual(Polymer.dom(firebaseLogin.root), null, 'Cannot get firebaseLogin\'s root');
    //   assert.notEqual(Polymer.dom(firebaseLogin.$.btnLogin), null, 'Cannot find "btnLogin" object');
    //   assert.notEqual(Polymer.dom(firebaseLogin.root).querySelector('#btnLogin'), null, 'Cannot find "btnLogin" living object');
    //   // Click the Login Button
    //   var btnLogin = Polymer.dom(firebaseLogin.root).querySelector('#btnLogin');
    //   btnLogin.click.bind(btnLogin);
    //   // Fill out your information
    //   var email = Polymer.dom(firebaseLogin.root).querySelector('#email');
    //   email.value = 'test@rbdcenter.org';
    //   var password = Polymer.dom(firebaseLogin.root).querySelector('#pass');
    //   password.value = 'test';
    //   // push the sign-in (Let's Go) button
    //   var passSignin = Polymer.dom(firebaseLogin.root).querySelector('#pass-signin');
    //   passSignin.click.bind(passSignin);
      // Check if we are logged in
      // firebaseLogin.addEventListener('user-changed', function(event) {
      //   assert.equal(event.detail.value.fName, 'TEST', event.detail.value);
      // });
      // firebaseLogin.addEventListener('message-changed', function(event) {
      //   assert.equal(event.detail.value, 'Good Stuff', event.detail.value)
      //   done();
      // });
      // firebaseLogin.login.bind(firebaseLogin)
      // firebaseLogin.user = {fName: 'TEST'};
      // assert.equal(firebaseLogin, 'Test', firebaseLogin)//'Test\'s first name should be "Test"');
    });

  });
</script>

</body>
</html>
